name: Scaricatore Pro
on:
  workflow_dispatch:
    inputs:
      category:
        description: 'Categoria'
        required: true
        default: 'mix'
      urls:
        description: 'Link'
        required: true
jobs:
  download:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: Scarica
        run: |
          mkdir -p gallery
          IFS=',' read -ra ADDR <<< "${{ github.event.inputs.urls }}"
          for url in "${ADDR[@]}"; do
            clean_url=$(echo $url | xargs)
            if [ -n "$clean_url" ]; then
              filename="gallery/${{ github.event.inputs.category }}_$(date +%s%N).jpg"
              curl -L "$clean_url" -o "$filename"
            fi
          done
      - name: Salva
        run: |
          git config --global user.name "aiimagemoz"
          git config --global user.email "aiimagemoz@users.noreply.github.com"
          git add -A
          git commit -m "Aggiunte nuove immagini" || echo "Nulla da aggiungere"
          git push origin main
